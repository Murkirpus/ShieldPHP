<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 20px;
        }

        .security-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .security-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4285f4, #34a853, #fbbc05, #ea4335);
        }

        .verification-box {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            background: #fafafa;
            margin: 25px 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .verification-box.checking {
            border-color: #4285f4;
            background: linear-gradient(135deg, #f0f4ff 0%, #e8f0fe 100%);
            box-shadow: 0 8px 25px rgba(66, 133, 244, 0.15);
        }

        .verification-box.verified {
            border-color: #34a853;
            background: linear-gradient(135deg, #f0fff4 0%, #e8f5e8 100%);
            box-shadow: 0 8px 25px rgba(52, 168, 83, 0.15);
        }

        .verification-box.failed {
            border-color: #ea4335;
            background: linear-gradient(135deg, #fff0f0 0%, #fce8e6 100%);
            box-shadow: 0 8px 25px rgba(234, 67, 53, 0.15);
        }

        .verification-content {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 20px;
        }

        .checkbox-container {
            position: relative;
            width: 28px;
            height: 28px;
        }

        .security-checkbox {
            width: 28px;
            height: 28px;
            border: 3px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .security-checkbox:hover {
            border-color: #4285f4;
            transform: scale(1.05);
        }

        .security-checkbox.checking {
            border-color: #4285f4;
            background: #f8f9ff;
        }

        .security-checkbox.verified {
            border-color: #34a853;
            background: #34a853;
            transform: scale(1.1);
        }

        .security-checkbox.failed {
            border-color: #ea4335;
            background: #ffeaea;
        }

        .checkmark {
            width: 16px;
            height: 16px;
            opacity: 0;
            transform: scale(0) rotate(0deg);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .checkmark.show {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }

        .security-spinner {
            width: 20px;
            height: 20px;
            border: 3px solid #e0e0e0;
            border-top: 3px solid #4285f4;
            border-radius: 50%;
            animation: securitySpin 1.2s linear infinite;
            opacity: 0;
            position: absolute;
        }

        .security-spinner.show {
            opacity: 1;
        }

        @keyframes securitySpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .verification-text {
            font-size: 18px;
            font-weight: 500;
            color: #333;
            user-select: none;
            flex: 1;
            text-align: left;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #666;
            margin-top: 15px;
            padding: 8px 12px;
            background: rgba(66, 133, 244, 0.05);
            border-radius: 20px;
            border: 1px solid rgba(66, 133, 244, 0.1);
        }

        .shield-icon {
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #4285f4, #1a73e8);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 11px;
        }

        .status-message {
            margin-top: 25px;
            padding: 20px;
            border-radius: 10px;
            opacity: 0;
            transform: translateY(15px);
            transition: all 0.4s ease;
            font-weight: 500;
        }

        .status-message.show {
            opacity: 1;
            transform: translateY(0);
        }

        .success-status {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .error-status {
            background: linear-gradient(135deg, #f8d7da, #f1b0b7);
            border: 1px solid #f1b0b7;
            color: #721c24;
        }

        .warning-status {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .security-button {
            background: linear-gradient(135deg, #4285f4, #1a73e8);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 0px;
            opacity: 0.4;
            pointer-events: none;
            position: relative;
            overflow: hidden;
        }
        .security-button.enabled {
            opacity: 1;
            pointer-events: auto;
        }

        .security-button.enabled:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(66, 133, 244, 0.4);
        }

        .security-button:active {
            transform: translateY(0);
        }

        h2 {
            color: #333;
            margin-bottom: 10px;
            font-size: 24px;
            font-weight: 600;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .security-details {
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 13px;
            color: #666;
            text-align: left;
            display: none;
            border: 1px solid #e9ecef;
        }

        .security-details.show {
            display: block;
        }

        .security-metric {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .security-metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: 500;
        }

        .metric-value {
            color: #333;
        }

        .security-level {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .level-low { background: #d4edda; color: #155724; }
        .level-medium { background: #fff3cd; color: #856404; }
        .level-high { background: #f8d7da; color: #721c24; }

        /* Honeypot - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç—ã–µ –ª–æ–≤—É—à–∫–∏ */
        .security-trap, .bot-trap, .hidden-field {
            position: absolute !important;
            left: -9999px !important;
            top: -9999px !important;
            opacity: 0 !important;
            pointer-events: none !important;
            width: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
            visibility: hidden !important;
            z-index: -1000 !important;
            border: none !important;
            background: transparent !important;
            color: transparent !important;
            font-size: 0 !important;
            line-height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4285f4, #34a853);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ honeypot –ª–æ–≤—É—à–∫–∏ - —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ -->
    <div style="position: absolute; left: -9999px; opacity: 0; pointer-events: none; width: 0; height: 0; visibility: hidden;">
        <input type="text" class="security-trap" name="email_address" tabindex="-1" autocomplete="off">
        <input type="text" class="bot-trap" name="user_website" tabindex="-1" autocomplete="off">
        <input type="password" class="hidden-field" name="security_token" tabindex="-1" autocomplete="off">
    </div>

    <div class="security-container">
        <h2>üõ°Ô∏è –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞</h2>
        <p class="subtitle">–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏</p>
        
        <div class="verification-box" id="verificationBox">
            <div class="verification-content">
                <div class="checkbox-container">
                    <div class="security-checkbox" id="securityCheckbox">
                        <div class="security-spinner" id="securitySpinner"></div>
                        <svg class="checkmark" id="securityCheckmark" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3">
                            <polyline points="20,6 9,17 4,12"></polyline>
                        </svg>
                    </div>
                </div>
                <div class="verification-text">–Ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é, —á—Ç–æ —è–≤–ª—è—é—Å—å —á–µ–ª–æ–≤–µ–∫–æ–º</div>
            </div>
            
            <div class="security-badge">
                <div class="shield-icon">üõ°</div>
                <span>AdvancedSecurity v2.0</span>
                <span style="margin-left: auto; font-size: 11px;">–ó–∞—â–∏—â–µ–Ω–æ –ò–ò</span>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
		<button class="security-button" id="securitySubmitButton">
            –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–µ–π
        </button>
        <div class="status-message success-status" id="successMessage">
            <strong>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</strong><br>
            –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –≤–∞—à—É –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å.
        </div>

        <div class="status-message error-status" id="errorMessage">
            <strong>‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong><br>
            –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥.
        </div>

        <div class="status-message warning-status" id="warningMessage">
            <strong>‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è</strong><br>
            –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∞—à–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ...
        </div>

       

        <div class="security-details" id="securityDetails">
            <strong>üìä –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</strong><br><br>
            <div id="securityMetrics"></div>
        </div>
    </div>

    <script>
        // –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤
        class IntegratedBotProtection {
            constructor() {
                // –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
                this.sessionStart = Date.now();
                this.pageLoadTime = performance.now();
                this.firstInteractionTime = null;
                
                // –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
                this.mouseData = [];
                this.clickEvents = [];
                this.keyboardData = [];
                this.scrollData = [];
                this.focusEvents = [];
                this.touchEvents = [];
                
                // Cookie –∏ —Å–µ—Å—Å–∏—è
                this.cookieTests = {};
                this.sessionTokens = {};
                this.dynamicValidation = {};
                
                // –ê–Ω–∞–ª–∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
                this.environmentData = {};
                this.browserFingerprint = {};
                this.deviceMetrics = {};
                
                // Honeypot –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
                this.honeypotTriggers = [];
                this.hiddenInteractions = [];
                
                // –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ - –ù–ê–ß–ò–ù–ê–ï–ú –° –ù–£–õ–Ø
                this.riskScore = 0; // –°—Ç–∞—Ä—Ç—É–µ–º —Å 0 –≤–º–µ—Å—Ç–æ undefined
                this.confidenceLevel = 0;
                this.detectionResults = {};
                this.verificationAttempts = 0;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º
                this.initializeProtection();
            }

            initializeProtection() {
                console.log('üõ°Ô∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞—â–∏—Ç—ã...');
                
                // –ö–†–ò–¢–ò–ß–ù–û: –û—á–∏—â–∞–µ–º –≤—Å–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
                this.clearPreviousSession();
                
                // –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º
                this.setupCookieProtection();
                this.setupBehaviorTracking();
                this.setupEnvironmentAnalysis();
                this.setupHoneypotTraps();
                this.setupTimingAnalysis();
                this.setupAdvancedFingerprinting();
                
                // –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
                this.startContinuousMonitoring();
                
                console.log('‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã');
            }

            clearPreviousSession() {
                try {
                    // –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ cookies
                    const simpleCookies = ['simple_test', 'activity'];
                    
                    simpleCookies.forEach(name => {
                        document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/`;
                    });
                    
                    console.log('üßπ –ü—Ä–æ—Å—Ç–∞—è –æ—á–∏—Å—Ç–∫–∞ cookies –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                } catch (e) {
                    console.log('‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞:', e.message);
                }
            }

            // === COOKIE –ó–ê–©–ò–¢–ê ===
            // === –£–ü–†–û–©–ï–ù–ù–ê–Ø COOKIE –ó–ê–©–ò–¢–ê ===
            setupCookieProtection() {
                console.log('üç™ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π cookie –∑–∞—â–∏—Ç—ã...');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º fallback –≤—Å–µ–≥–¥–∞
                this.cookieFallback = {};
                this.cookiesWorking = 0;
                
                // –ü—Ä–æ–±—É–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¢–û–õ–¨–ö–û –æ–¥–∏–Ω –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π cookie
                const testValue = 'test123';
                
                try {
                    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π cookie –±–µ–∑ –≤—Å—è–∫–∏—Ö —Ñ–ª–∞–≥–æ–≤
                    document.cookie = `simple_test=${testValue}`;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ 50ms
                    setTimeout(() => {
                        const testResult = document.cookie.includes(`simple_test=${testValue}`);
                        if (testResult) {
                            this.cookiesSupported = true;
                            this.cookiesWorking = 1;
                            console.log('‚úÖ –ü—Ä–æ—Å—Ç—ã–µ cookies —Ä–∞–±–æ—Ç–∞—é—Ç');
                        } else {
                            this.cookiesSupported = false;
                            console.log('‚ùå Cookies –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                        }
                    }, 50);
                    
                } catch (e) {
                    this.cookiesSupported = false;
                    console.log('‚ùå –û—à–∏–±–∫–∞ cookies:', e.message);
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ fallback (–≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
                this.cookieFallback.session_id = this.generateSecureToken(16);
                this.cookieFallback.start_time = Date.now().toString();
                this.cookieFallback.page_visits = '1';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                this.cookieTests = {
                    session: this.cookieFallback.session_id,
                    time: this.cookieFallback.start_time
                };
                
                console.log('üç™ Cookie —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (fallback –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω)');
            }

            setCookie(name, value, hours) {
                try {
                    const expires = new Date(Date.now() + hours * 3600000);
                    // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ cookie
                    const variants = [
                        `${name}=${value};expires=${expires.toUTCString()};path=/`,
                        `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Lax`,
                        `${name}=${value};max-age=${hours * 3600};path=/`
                    ];
                    
                    // –ü—Ä–æ–±—É–µ–º –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
                    for (let variant of variants) {
                        document.cookie = variant;
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –ª–∏ cookie
                        if (this.testCookieSet(name, value)) {
                            return true;
                        }
                    }
                    
                    // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
                    this.cookieFallback = this.cookieFallback || {};
                    this.cookieFallback[name] = value;
                    return false;
                } catch (e) {
                    // Fallback - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø–∞–º—è—Ç–∏
                    this.cookieFallback = this.cookieFallback || {};
                    this.cookieFallback[name] = value;
                    return false;
                }
            }

            testCookieSet(name, expectedValue) {
                try {
                    const cookies = document.cookie.split(';');
                    for (let cookie of cookies) {
                        const [cookieName, cookieValue] = cookie.trim().split('=');
                        if (cookieName === name && cookieValue === expectedValue) {
                            return true;
                        }
                    }
                    return false;
                } catch (e) {
                    return false;
                }
            }

            getCookie(name) {
                try {
                    const cookie = document.cookie.split(';')
                        .find(row => row.trim().startsWith(name + '='))
                        ?.split('=')[1] || null;
                    
                    // –ï—Å–ª–∏ cookie –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è–µ–º fallback
                    if (!cookie && this.cookieFallback && this.cookieFallback[name]) {
                        return this.cookieFallback[name];
                    }
                    
                    return cookie;
                } catch (e) {
                    // Fallback –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥
                    return this.cookieFallback && this.cookieFallback[name] || null;
                }
            }

            updateDynamicCookies() {
                // –ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ fallback (–≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
                const activity = this.mouseData.length + this.clickEvents.length;
                this.cookieFallback.activity = activity.toString();
                this.cookieFallback.last_update = Date.now().toString();
                
                // –ü—Ä–æ–±—É–µ–º –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ cookies –µ—Å–ª–∏ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
                if (this.cookiesSupported) {
                    try {
                        document.cookie = `activity=${activity}`;
                    } catch (e) {
                        // –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, fallback —Ä–∞–±–æ—Ç–∞–µ—Ç
                    }
                }
            }

            validateCookieIntegrity() {
                let cookieViolations = 0;
                
                Object.keys(this.cookieTests).forEach(key => {
                    const expected = this.cookieTests[key];
                    const actual = this.getCookie(`sec_${key}`);
                    if (!actual || actual !== expected.toString()) {
                        cookieViolations++;
                        this.riskScore += 15;
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ cookies
                const totalCookies = document.cookie.split(';').filter(c => c.trim()).length;
                if (totalCookies < 4) {
                    this.riskScore += 25;
                }
                
                return cookieViolations === 0;
            }

            // === –ü–û–í–ï–î–ï–ù–ß–ï–°–ö–û–ï –û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–ï ===
            setupBehaviorTracking() {
                // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º—ã—à–∏ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
                document.addEventListener('mousemove', (e) => {
                    if (!this.firstInteractionTime) this.firstInteractionTime = Date.now();
                    
                    this.mouseData.push({
                        x: e.clientX,
                        y: e.clientY,
                        timestamp: Date.now(),
                        movementX: e.movementX || 0,
                        movementY: e.movementY || 0,
                        pressure: e.pressure || 0
                    });
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Ç–æ—á–µ–∫
                    if (this.mouseData.length > 100) {
                        this.mouseData.shift();
                    }
                });

                // –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤
                document.addEventListener('click', (e) => {
                    this.clickEvents.push({
                        x: e.clientX,
                        y: e.clientY,
                        timestamp: Date.now(),
                        button: e.button,
                        target: e.target.tagName,
                        ctrlKey: e.ctrlKey,
                        altKey: e.altKey,
                        shiftKey: e.shiftKey,
                        detail: e.detail, // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤
                        isTrusted: e.isTrusted
                    });
                });

                // –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
                document.addEventListener('keydown', (e) => {
                    this.keyboardData.push({
                        key: e.key,
                        code: e.code,
                        timestamp: Date.now(),
                        ctrlKey: e.ctrlKey,
                        altKey: e.altKey,
                        shiftKey: e.shiftKey,
                        isTrusted: e.isTrusted,
                        location: e.location
                    });
                });

                // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
                window.addEventListener('scroll', (e) => {
                    this.scrollData.push({
                        scrollY: window.scrollY,
                        scrollX: window.scrollX,
                        timestamp: Date.now(),
                        deltaY: e.deltaY || 0,
                        deltaMode: e.deltaMode || 0
                    });
                });

                // –°–æ–±—ã—Ç–∏—è —Ñ–æ–∫—É—Å–∞/—Ä–∞—Å—Ñ–æ–∫—É—Å–∞
                ['focus', 'blur', 'visibilitychange'].forEach(event => {
                    document.addEventListener(event, () => {
                        this.focusEvents.push({
                            type: event,
                            timestamp: Date.now(),
                            hidden: document.hidden
                        });
                    });
                });

                // Touch —Å–æ–±—ã—Ç–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                ['touchstart', 'touchmove', 'touchend'].forEach(event => {
                    document.addEventListener(event, (e) => {
                        if (e.touches[0]) {
                            this.touchEvents.push({
                                type: event,
                                x: e.touches[0].clientX,
                                y: e.touches[0].clientY,
                                pressure: e.touches[0].force || 0,
                                timestamp: Date.now()
                            });
                        }
                    });
                });
            }

            // === –ê–ù–ê–õ–ò–ó –û–ö–†–£–ñ–ï–ù–ò–Ø ===
            setupEnvironmentAnalysis() {
                this.environmentData = {
                    // –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    language: navigator.language,
                    languages: navigator.languages.join(','),
                    cookieEnabled: navigator.cookieEnabled,
                    
                    // –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
                    webdriver: navigator.webdriver || false,
                    phantom: !!window.phantom,
                    selenium: !!window._selenium,
                    webdriverio: !!window.webdriverio,
                    
                    // –†–∞–∑–º–µ—Ä—ã –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
                    screenWidth: screen.width,
                    screenHeight: screen.height,
                    availWidth: screen.availWidth,
                    availHeight: screen.availHeight,
                    colorDepth: screen.colorDepth,
                    pixelDepth: screen.pixelDepth,
                    
                    // –û–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞
                    windowWidth: window.innerWidth,
                    windowHeight: window.innerHeight,
                    outerWidth: window.outerWidth,
                    outerHeight: window.outerHeight,
                    
                    // –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ –∏ –≤—Ä–µ–º—è
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    timezoneOffset: new Date().getTimezoneOffset(),
                    
                    // –ü–ª–∞–≥–∏–Ω—ã –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
                    pluginsCount: navigator.plugins.length,
                    mimeTypesCount: navigator.mimeTypes.length,
                    
                    // WebGL –∏ Canvas –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                    webglVendor: this.getWebGLVendor(),
                    webglRenderer: this.getWebGLRenderer(),
                    canvasFingerprint: this.generateCanvasFingerprint(),
                    
                    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
                    hasChrome: !!window.chrome,
                    hasOpera: !!window.opera,
                    hasSafari: /Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent),
                    
                    // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                    hardwareConcurrency: navigator.hardwareConcurrency || 0,
                    deviceMemory: navigator.deviceMemory || 0,
                    maxTouchPoints: navigator.maxTouchPoints || 0
                };

                this.analyzeEnvironmentSuspicion();
            }

            analyzeEnvironmentSuspicion() {
                console.log('üîç –ê–Ω–∞–ª–∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è - –º—è–≥–∫–∏–π —Ä–µ–∂–∏–º...');
                
                // –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ï —à—Ç—Ä–∞—Ñ—ã —Ç–æ–ª—å–∫–æ –∑–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
                if (this.environmentData.webdriver) {
                    this.riskScore += 30; // —É–º–µ–Ω—å—à–∏–ª–∏ —Å 50
                    console.log('‚ö†Ô∏è WebDriver –æ–±–Ω–∞—Ä—É–∂–µ–Ω: +30 —Ä–∏—Å–∫–∞');
                }
                if (this.environmentData.phantom) {
                    this.riskScore += 35; // —É–º–µ–Ω—å—à–∏–ª–∏ —Å 60  
                    console.log('‚ö†Ô∏è PhantomJS –æ–±–Ω–∞—Ä—É–∂–µ–Ω: +35 —Ä–∏—Å–∫–∞');
                }
                if (this.environmentData.selenium) {
                    this.riskScore += 35; // —É–º–µ–Ω—å—à–∏–ª–∏ —Å 60
                    console.log('‚ö†Ô∏è Selenium –æ–±–Ω–∞—Ä—É–∂–µ–Ω: +35 —Ä–∏—Å–∫–∞');
                }
                
                // –£–±–∏—Ä–∞–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö —à—Ç—Ä–∞—Ñ–æ–≤ - –æ–Ω–∏ —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã
                // –ù–ï —à—Ç—Ä–∞—Ñ—É–µ–º –∑–∞ —Ä–∞–∑–º–µ—Ä—ã —ç–∫—Ä–∞–Ω–∞, –ø–ª–∞–≥–∏–Ω—ã, —è–∑—ã–∫–∏ - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ
                
                console.log(`üîç –ê–Ω–∞–ª–∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω, –æ–±—â–∏–π —Ä–∏—Å–∫: ${this.riskScore}`);
            }

            getWebGLVendor() {
                try {
                    const canvas = document.createElement('canvas');
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    return gl ? gl.getParameter(gl.VENDOR) : 'unknown';
                } catch (e) {
                    return 'error';
                }
            }

            getWebGLRenderer() {
                try {
                    const canvas = document.createElement('canvas');
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    return gl ? gl.getParameter(gl.RENDERER) : 'unknown';
                } catch (e) {
                    return 'error';
                }
            }

            generateCanvasFingerprint() {
                try {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const txt = 'BotDetectionü§ñ2025';
                    
                    ctx.textBaseline = 'top';
                    ctx.font = '14px Arial';
                    ctx.fillStyle = '#f60';
                    ctx.fillRect(125, 1, 62, 20);
                    ctx.fillStyle = '#069';
                    ctx.fillText(txt, 2, 15);
                    ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
                    ctx.fillText(txt, 4, 17);
                    
                    return canvas.toDataURL().slice(-50); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–∏–º–≤–æ–ª–æ–≤
                } catch (e) {
                    return 'error';
                }
            }

            // === HONEYPOT –õ–û–í–£–®–ö–ò ===
            // === HONEYPOT –û–¢–ö–õ–Æ–ß–ï–ù –î–õ–Ø –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò ===
            setupHoneypotTraps() {
                console.log('üçØ Honeypot —Å–∏—Å—Ç–µ–º–∞ –û–¢–ö–õ–Æ–ß–ï–ù–ê –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã
                this.honeypotTriggers = [];
                this.hiddenInteractions = [];
                
                // –ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è - –æ—Å—Ç–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞–∫ –¥–µ–∫–æ—Ä–∞—Ü–∏—é
                // –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Å–∏—Å—Ç–µ–º–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ª—é–±—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
                
                console.log('‚úÖ Honeypot –æ—Ç–∫–ª—é—á–µ–Ω, —Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ');
            }

            // === –í–†–ï–ú–ï–ù–ù–û–ô –ê–ù–ê–õ–ò–ó ===
            setupTimingAnalysis() {
                // –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
                this.firstPaintTime = performance.getEntriesByType('paint')
                    .find(entry => entry.name === 'first-contentful-paint')?.startTime || 0;
                
                // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
                setInterval(() => this.analyzeTimingPatterns(), 2000);
            }

            analyzeTimingPatterns() {
                const now = Date.now();
                const sessionDuration = now - this.sessionStart;
                
                // –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
                if (this.firstInteractionTime && (this.firstInteractionTime - this.sessionStart) < 500) {
                    this.riskScore += 25;
                }
                
                // –ê–Ω–∞–ª–∏–∑ —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏–π
                if (this.clickEvents.length > 3) {
                    const intervals = [];
                    for (let i = 1; i < this.clickEvents.length; i++) {
                        intervals.push(this.clickEvents[i].timestamp - this.clickEvents[i-1].timestamp);
                    }
                    
                    const avgInterval = intervals.reduce((a, b) => a + b, 0) / intervals.length;
                    const variance = intervals.reduce((acc, val) => acc + Math.pow(val - avgInterval, 2), 0) / intervals.length;
                    
                    // –°–ª–∏—à–∫–æ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã = –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ
                    if (variance < 1000 && avgInterval < 200) {
                        this.riskScore += 35;
                    }
                }
            }

            // === –ü–†–û–î–í–ò–ù–£–¢–´–ô –§–ò–ù–ì–ï–†–ü–†–ò–ù–¢–ò–ù–ì ===
            setupAdvancedFingerprinting() {
                this.audioFingerprintAttempted = false;
                
                this.browserFingerprint = {
                    // Audio context fingerprinting - –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π
                    audioFingerprint: this.generateAudioFingerprint(),
                    
                    // WebRTC fingerprinting
                    webrtcFingerprint: this.generateWebRTCFingerprint(),
                    
                    // Battery API (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
                    batteryLevel: this.getBatteryInfo(),
                    
                    // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è capabilities
                    geolocationSupport: !!navigator.geolocation,
                    
                    // Media devices
                    mediaDevices: this.getMediaDevicesInfo(),
                    
                    // Font detection
                    availableFonts: this.detectAvailableFonts(),
                    
                    // Storage quota
                    storageQuota: this.getStorageQuota()
                };
                
                // –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å audio fingerprint –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞
                document.addEventListener('click', () => {
                    if (!this.audioFingerprintAttempted) {
                        setTimeout(() => {
                            this.browserFingerprint.audioFingerprint = this.generateAudioFingerprint();
                            console.log('üîä Audio fingerprint –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è');
                        }, 100);
                    }
                }, { once: true });
            }

            generateAudioFingerprint() {
                // –û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (!this.audioFingerprintAttempted && this.clickEvents.length === 0) {
                    return 'pending_user_interaction';
                }
                
                this.audioFingerprintAttempted = true;
                
                try {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ä–∞–∑—Ä–µ—à–µ–Ω –ª–∏ AudioContext
                    const AudioContextClass = window.AudioContext || window.webkitAudioContext;
                    if (!AudioContextClass) {
                        return 'not_supported';
                    }
                    
                    const audioContext = new AudioContextClass();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
                    if (audioContext.state === 'suspended') {
                        // –ù–µ –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - —ç—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
                        audioContext.close();
                        return 'suspended_context';
                    }
                    
                    const oscillator = audioContext.createOscillator();
                    const analyser = audioContext.createAnalyser();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.type = 'triangle';
                    oscillator.frequency.value = 1000;
                    gainNode.gain.value = 0; // –ë–µ–∑ –∑–≤—É–∫–∞
                    
                    oscillator.connect(analyser);
                    analyser.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—á–µ–Ω—å –∫—Ä–∞—Ç–∫–æ
                    oscillator.start(0);
                    oscillator.stop(audioContext.currentTime + 0.001); // 1ms
                    
                    const data = new Uint8Array(analyser.frequencyBinCount);
                    analyser.getByteFrequencyData(data);
                    
                    audioContext.close();
                    return Array.from(data).slice(0, 10).join(',') || 'empty_data';
                } catch (e) {
                    console.log('‚ÑπÔ∏è Audio fingerprinting –æ—Ç–∫–ª—é—á–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è)');
                    return 'audio_blocked';
                }
            }

            generateWebRTCFingerprint() {
                return new Promise((resolve) => {
                    if (!window.RTCPeerConnection) {
                        resolve('unavailable');
                        return;
                    }
                    
                    const pc = new RTCPeerConnection({iceServers: []});
                    pc.createDataChannel('');
                    pc.createOffer().then(offer => pc.setLocalDescription(offer));
                    
                    pc.onicecandidate = (event) => {
                        if (event.candidate) {
                            const candidate = event.candidate.candidate;
                            const ip = candidate.match(/(\d+\.\d+\.\d+\.\d+)/);
                            if (ip) {
                                pc.close();
                                resolve(ip[1]);
                            }
                        }
                    };
                    
                    setTimeout(() => {
                        pc.close();
                        resolve('timeout');
                    }, 1000);
                });
            }

            getBatteryInfo() {
                if (navigator.getBattery) {
                    return navigator.getBattery().then(battery => ({
                        level: battery.level,
                        charging: battery.charging
                    })).catch(() => 'unavailable');
                }
                return 'unavailable';
            }

            getMediaDevicesInfo() {
                if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
                    return navigator.mediaDevices.enumerateDevices()
                        .then(devices => ({
                            audioInputs: devices.filter(d => d.kind === 'audioinput').length,
                            videoInputs: devices.filter(d => d.kind === 'videoinput').length,
                            audioOutputs: devices.filter(d => d.kind === 'audiooutput').length
                        }))
                        .catch(() => ({ audioInputs: 0, videoInputs: 0, audioOutputs: 0 }));
                }
                return { audioInputs: 0, videoInputs: 0, audioOutputs: 0 };
            }

            detectAvailableFonts() {
                const baseFonts = ['monospace', 'sans-serif', 'serif'];
                const testFonts = ['Arial', 'Helvetica', 'Times', 'Courier', 'Verdana', 'Georgia', 'Palatino', 'Garamond', 'Bookman', 'Comic Sans MS'];
                const testSize = '72px';
                const testText = 'mmmmmmmmmmlli';
                
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                
                const baseMeasurements = baseFonts.map(font => {
                    context.font = testSize + ' ' + font;
                    return context.measureText(testText).width;
                });
                
                return testFonts.filter(font => {
                    return baseFonts.some((baseFont, index) => {
                        context.font = testSize + ' ' + font + ', ' + baseFont;
                        return context.measureText(testText).width !== baseMeasurements[index];
                    });
                });
            }

            getStorageQuota() {
                if (navigator.storage && navigator.storage.estimate) {
                    return navigator.storage.estimate()
                        .then(estimate => ({
                            quota: estimate.quota,
                            usage: estimate.usage
                        }))
                        .catch(() => ({ quota: 0, usage: 0 }));
                }
                return { quota: 0, usage: 0 };
            }

            // === –ù–ï–ü–†–ï–†–´–í–ù–´–ô –ú–û–ù–ò–¢–û–†–ò–ù–ì ===
            startContinuousMonitoring() {
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ risk score –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
                setInterval(() => {
                    this.updateRiskAssessment();
                    this.updateConfidenceLevel();
                }, 2000);
                
                // –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
                setInterval(() => {
                    this.performDeepAnalysis();
                }, 10000);
            }

            updateRiskAssessment() {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º - —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
                const criticalRisk = (this.honeypotTriggers?.length || 0) * 100 + 
                                   (this.environmentData?.webdriver ? 50 : 0) +
                                   (this.environmentData?.phantom ? 60 : 0);
                
                // –ü–û–õ–ù–û–°–¢–¨–Æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–∏—Å–∫ –¥–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞
                this.riskScore = criticalRisk;
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è (–º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π —Ä–∏—Å–∫)
                this.analyzeBehaviorPatterns();
                this.analyzeInteractionQuality(); 
                this.validateSessionConsistency();
                
                // –ú–û–©–ù–´–ï –ü–û–ó–ò–¢–ò–í–ù–´–ï –§–ê–ö–¢–û–†–´ (–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–∞)
                const sessionTime = Date.now() - this.sessionStart;
                
                // –ë–∞–∑–æ–≤—ã–µ –±–æ–Ω—É—Å—ã –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                if (this.mouseData?.length > 5) this.riskScore -= 20;
                if (this.mouseData?.length > 20) this.riskScore -= 15; // –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å
                if (this.mouseData?.length > 50) this.riskScore -= 10; // –µ—â–µ –±–æ–ª—å—à–µ
                
                if (this.clickEvents?.length > 0) this.riskScore -= 15;
                if (this.clickEvents?.length > 2) this.riskScore -= 10;
                
                if (this.keyboardData?.length > 0) this.riskScore -= 12;
                if (this.scrollData?.length > 0) this.riskScore -= 8;
                
                // –í—Ä–µ–º–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã
                if (sessionTime > 5000) this.riskScore -= 25;  // 5+ —Å–µ–∫—É–Ω–¥
                if (sessionTime > 15000) this.riskScore -= 15; // 15+ —Å–µ–∫—É–Ω–¥
                if (sessionTime > 30000) this.riskScore -= 10; // 30+ —Å–µ–∫—É–Ω–¥
                
                // –ë–æ–Ω—É—Å –∑–∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
                const interactionTypes = [
                    (this.mouseData?.length || 0) > 0,
                    (this.clickEvents?.length || 0) > 0, 
                    (this.keyboardData?.length || 0) > 0,
                    (this.scrollData?.length || 0) > 0,
                    (this.focusEvents?.length || 0) > 0
                ].filter(Boolean).length;
                
                this.riskScore -= interactionTypes * 8; // 8 –±–∞–ª–ª–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–π —Ç–∏–ø
                
                // –û—Å–æ–±—ã–π –±–æ–Ω—É—Å –∑–∞ –≤–∞–ª–∏–¥–Ω—ã–µ cookies –∏–ª–∏ fallback
                if (this.cookiesSupported === true) {
                    this.riskScore -= 20;
                } else if (this.cookieFallback && Object.keys(this.cookieFallback).length > 0) {
                    this.riskScore -= 15; // fallback —Ç–æ–∂–µ —Ö–æ—Ä–æ—à–æ
                }
                
                // –£–±–∏—Ä–∞–µ–º —à—Ç—Ä–∞—Ñ—ã –∑–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –µ—Å–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ö–æ—Ä–æ—à–µ–µ
                if ((this.verificationAttempts || 0) > 2 && (this.mouseData?.length || 0) > 15) {
                    this.riskScore -= (this.verificationAttempts || 0) * 5;
                }
                
                // –°–¢–†–û–ì–û –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∏—Å–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 0-100
                this.riskScore = Math.max(0, Math.min(100, this.riskScore));
                
                console.log(`üìä Risk score –æ–±–Ω–æ–≤–ª–µ–Ω: ${this.riskScore}/100, –¥–æ–≤–µ—Ä–∏–µ: ${this.confidenceLevel}%`);
            }

            analyzeBehaviorPatterns() {
                // –ê–Ω–∞–ª–∏–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏–π –º—ã—à–∏ - –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ï —à—Ç—Ä–∞—Ñ—ã
                if ((this.mouseData?.length || 0) > 10) {
                    const movements = this.mouseData.slice(-20);
                    let suspiciousCount = 0;
                    
                    for (let i = 2; i < movements.length; i++) {
                        const prev = movements[i-1];
                        const curr = movements[i];
                        const prev2 = movements[i-2];
                        
                        // –û—á–µ–Ω—å —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å
                        const slope1 = (prev.y - prev2.y) / (prev.x - prev2.x || 1);
                        const slope2 = (curr.y - prev.y) / (curr.x - prev.x || 1);
                        
                        if (Math.abs(slope1 - slope2) < 0.01) { // –æ—á–µ–Ω—å —Å—Ç—Ä–æ–≥–∏–π –∫—Ä–∏—Ç–µ—Ä–∏–π
                            suspiciousCount++;
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –û–ß–ï–ù–¨ –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å
                        const distance = Math.sqrt(Math.pow(curr.x - prev.x, 2) + Math.pow(curr.y - prev.y, 2));
                        const time = curr.timestamp - prev.timestamp;
                        if (time > 0 && distance / time > 10) { // –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥
                            suspiciousCount++;
                        }
                    }
                    
                    // –®—Ç—Ä–∞—Ñ—ã —Ç–æ–ª—å–∫–æ –∑–∞ –û–ß–ï–ù–¨ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
                    if (suspiciousCount > movements.length * 0.95) { // 95% –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π
                        this.riskScore += 15; // –Ω–µ–±–æ–ª—å—à–æ–π —à—Ç—Ä–∞—Ñ
                    }
                } else {
                    // –ù–µ–±–æ–ª—å—à–æ–π —à—Ç—Ä–∞—Ñ –∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –º—ã—à–∏
                    this.riskScore += 5;
                }
            }

            analyzeInteractionQuality() {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ isTrusted —Å–æ–±—ã—Ç–∏—è - –û–ß–ï–ù–¨ –º—è–≥–∫–æ
                const untrustedClicks = (this.clickEvents || []).filter(click => !click.isTrusted).length;
                const untrustedKeys = (this.keyboardData || []).filter(key => !key.isTrusted).length;
                
                // –¢–æ–ª—å–∫–æ —Å–µ—Ä—å–µ–∑–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã –∑–∞ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ untrusted —Å–æ–±—ã—Ç–∏–π
                if (untrustedClicks > 5) this.riskScore += untrustedClicks * 3; // —É–º–µ–Ω—å—à–∏–ª–∏ —à—Ç—Ä–∞—Ñ
                if (untrustedKeys > 10) this.riskScore += untrustedKeys * 2;     // —É–º–µ–Ω—å—à–∏–ª–∏ —à—Ç—Ä–∞—Ñ
            }

            validateSessionConsistency() {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏ - –ë–û–õ–ï–ï –ú–Ø–ì–ö–û
                const sessionDuration = Date.now() - this.sessionStart;
                const interactionCount = (this.mouseData?.length || 0) + (this.clickEvents?.length || 0) + (this.keyboardData?.length || 0);
                
                // –¢–æ–ª—å–∫–æ –û–ß–ï–ù–¨ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
                if (sessionDuration < 1000 && interactionCount > 100) {
                    // –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∑–∞ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
                    this.riskScore += 20; // —É–º–µ–Ω—å—à–∏–ª–∏ —à—Ç—Ä–∞—Ñ
                }
                
                // –£–±—Ä–∞–ª–∏ —à—Ç—Ä–∞—Ñ –∑–∞ –º–∞–ª–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            }

            performDeepAnalysis() {
                console.log('üîç –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏...');
                
                // –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º
                this.detectionResults = {
                    cookieIntegrity: this.validateCookieIntegrity(),
                    behaviorAnalysis: this.analyzeBehaviorPatterns(),
                    environmentCheck: this.environmentData.webdriver || this.environmentData.phantom,
                    honeypotStatus: this.honeypotTriggers.length === 0,
                    timingAnalysis: this.analyzeTimingPatterns(),
                    overallRisk: this.riskScore
                };
            }

            updateConfidenceLevel() {
                const sessionTime = Date.now() - this.sessionStart;
                
                const factors = [
                    this.mouseData.length > 10 ? 25 : this.mouseData.length > 5 ? 15 : 5,
                    this.clickEvents.length > 2 ? 20 : this.clickEvents.length > 0 ? 10 : 0,
                    this.keyboardData.length > 0 ? 15 : 0,
                    this.validateCookieIntegrity() ? 20 : 10,
                    this.honeypotTriggers.length === 0 ? 15 : 0,
                    sessionTime > 10000 ? 15 : sessionTime > 5000 ? 10 : 5,
                    this.scrollData.length > 0 ? 10 : 0,
                    // –ë–æ–Ω—É—Å –∑–∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
                    this.focusEvents.length > 0 ? 5 : 0
                ];
                
                this.confidenceLevel = Math.min(100, factors.reduce((sum, factor) => sum + factor, 0));
                
                console.log(`üíØ –£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω: ${this.confidenceLevel}%`);
            }

            // === –ì–õ–ê–í–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê ===
            performFinalVerification() {
                console.log('üõ°Ô∏è –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –£–ü–†–û–©–ï–ù–ù–û–ô –ø—Ä–æ–≤–µ—Ä–∫–∏...');
                
                this.verificationAttempts = (this.verificationAttempts || 0) + 1;
                
                // –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–∏—Å–∫ –≤ –Ω–∞—á–∞–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
                this.riskScore = 0;
                console.log('üîÑ Risk score –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—à–µ–Ω –≤ 0');
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞ —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞
                this.updateRiskAssessment();
                
                console.log('üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å—á–µ—Ç–∞:', {
                    riskScore: this.riskScore,
                    confidenceLevel: this.confidenceLevel,
                    mouseData: this.mouseData?.length || 0,
                    clickEvents: this.clickEvents?.length || 0
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –ö–†–ò–¢–ò–ß–ï–°–ö–£–Æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é
                if (this.environmentData?.webdriver || this.environmentData?.phantom) {
                    console.log('üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞');
                    return { 
                        success: false, 
                        reason: 'automation_detected', 
                        confidence: 95, 
                        riskScore: 100, 
                        details: this.generateDetailedReport() 
                    };
                }
                
                // –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º —á—Ç–æ –≤—Å–µ scores –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã
                const finalRiskScore = Math.max(0, Math.min(100, this.riskScore || 0));
                const finalConfidence = Math.max(0, Math.min(100, this.confidenceLevel || 0));
                
                // –û–ß–ï–ù–¨ –ú–Ø–ì–ö–ò–ï —É—Å–ª–æ–≤–∏—è —É—Å–ø–µ—Ö–∞
                const hasMinimalActivity = (this.mouseData?.length || 0) > 3 || (this.clickEvents?.length || 0) > 0;
                const hasAnyStorage = this.cookiesSupported === true || (this.cookieFallback && Object.keys(this.cookieFallback).length > 0);
                const noAutomation = !this.environmentData?.webdriver && !this.environmentData?.phantom;
                const hasTime = Date.now() - this.sessionStart > 1000; // –≤—Å–µ–≥–æ 1 —Å–µ–∫—É–Ω–¥–∞
                
                // –û—á–µ–Ω—å –º—è–≥–∫–∏–µ —É—Å–ª–æ–≤–∏—è - —Ç–æ–ª—å–∫–æ 3 –∏–∑ 4 –Ω—É–∂–Ω—ã
                const successConditions = [
                    finalRiskScore < 80,    // –æ—á–µ–Ω—å –º—è–≥–∫–∏–π –ª–∏–º–∏—Ç —Ä–∏—Å–∫–∞
                    hasMinimalActivity,     // –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                    hasAnyStorage,          // –ª—é–±–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
                    noAutomation,           // –Ω–µ—Ç —è–≤–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
                    hasTime,                // –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
                    finalConfidence > 30    // –±–∞–∑–æ–≤–æ–µ –¥–æ–≤–µ—Ä–∏–µ
                ];
                
                const successCount = successConditions.filter(Boolean).length;
                const isHuman = successCount >= 4; // 4 –∏–∑ 6 —É—Å–ª–æ–≤–∏–π
                
                console.log(`‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –û–¶–ï–ù–ö–ê: ${successCount}/6 —É—Å–ª–æ–≤–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ`);
                console.log(`üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç: ${isHuman ? '–£–°–ü–ï–•' : '–ù–ï–£–î–ê–ß–ê'}, Risk: ${finalRiskScore}/100`);
                
                const result = {
                    success: isHuman,
                    reason: isHuman ? 'verification_passed' : 'suspicious_behavior',
                    confidence: finalConfidence,
                    riskScore: finalRiskScore, // –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ <= 100
                    successConditions: successCount,
                    details: this.generateDetailedReport()
                };
                
                console.log('üìã –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:', result);
                return result;
            }

            generateDetailedReport() {
                const now = Date.now();
                const sessionDuration = now - this.sessionStart;
                
                return {
                    sessionDuration: sessionDuration,
                    mouseMovements: this.mouseData?.length || 0,
                    clickEvents: this.clickEvents?.length || 0,
                    keyboardEvents: this.keyboardData?.length || 0,
                    scrollEvents: this.scrollData?.length || 0,
                    touchEvents: this.touchEvents?.length || 0,
                    focusEvents: this.focusEvents?.length || 0,
                    honeypotTriggers: this.honeypotTriggers?.length || 0,
                    cookieStatus: this.cookiesSupported,
                    cookiesSupported: this.cookiesSupported,
                    cookiesWorking: this.cookiesWorking || 0,
                    fallbackActive: this.cookieFallback ? Object.keys(this.cookieFallback).length : 0,
                    environmentRisk: this.environmentData || {},
                    verificationAttempts: this.verificationAttempts || 0,
                    finalRiskScore: this.riskScore || 0,
                    confidenceLevel: this.confidenceLevel || 0,
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    debug: {
                        startTime: this.sessionStart,
                        currentTime: now,
                        riskScore: this.riskScore,
                        confidence: this.confidenceLevel,
                        mouseDataExists: !!this.mouseData,
                        clickEventsExists: !!this.clickEvents
                    }
                };
            }

            // === –£–¢–ò–õ–ò–¢–´ ===
            generateSecureToken(length) {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                let result = '';
                const array = new Uint8Array(length);
                crypto.getRandomValues(array);
                for (let i = 0; i < length; i++) {
                    result += chars[array[i] % chars.length];
                }
                return result;
            }

            createBrowserHash() {
                const data = [
                    navigator.userAgent,
                    navigator.language,
                    screen.width + 'x' + screen.height,
                    new Date().getTimezoneOffset(),
                    navigator.platform
                ].join('|');
                
                return btoa(data).slice(0, 16);
            }

            calculateActivityScore() {
                return Math.floor(
                    this.mouseData.length * 1 +
                    this.clickEvents.length * 3 +
                    this.keyboardData.length * 2 +
                    this.scrollData.length * 1.5
                );
            }
        }

        // === –ò–ù–¢–ï–†–§–ï–ô–° –ò –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ï ===
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã
        const protection = new IntegratedBotProtection();

        // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const verificationBox = document.getElementById('verificationBox');
        const securityCheckbox = document.getElementById('securityCheckbox');
        const securitySpinner = document.getElementById('securitySpinner');
        const securityCheckmark = document.getElementById('securityCheckmark');
        const progressFill = document.getElementById('progressFill');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        const warningMessage = document.getElementById('warningMessage');
        const securitySubmitButton = document.getElementById('securitySubmitButton');
        const securityDetails = document.getElementById('securityDetails');
        const securityMetrics = document.getElementById('securityMetrics');

        let isVerified = false;
        let isVerifying = false;

        // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        securityCheckbox.addEventListener('click', async function() {
            if (isVerified || isVerifying) return;
            
            startVerificationProcess();
        });

        async function startVerificationProcess() {
            isVerifying = true;
            
            // –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
            verificationBox.classList.add('checking');
            securityCheckbox.classList.add('checking');
            securitySpinner.classList.add('show');
            
            // –°–±—Ä–æ—Å –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            [successMessage, errorMessage, warningMessage].forEach(msg => 
                msg.classList.remove('show')
            );
            
            // –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                progressFill.style.width = Math.min(progress, 90) + '%';
            }, 200);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            setTimeout(() => {
                warningMessage.classList.add('show');
            }, 1000);
            
            // –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É (3-5 —Å–µ–∫—É–Ω–¥)
            const verificationDelay = 3000 + Math.random() * 2000;
            
            setTimeout(async () => {
                clearInterval(progressInterval);
                progressFill.style.width = '100%';
                
                const result = await protection.performFinalVerification();
                finishVerification(result);
            }, verificationDelay);
        }

        function finishVerification(result) {
            isVerifying = false;
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            securitySpinner.classList.remove('show');
            warningMessage.classList.remove('show');
            verificationBox.classList.remove('checking');
            securityCheckbox.classList.remove('checking');
            
            if (result.success) {
                // –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                isVerified = true;
                verificationBox.classList.add('verified');
                securityCheckbox.classList.add('verified');
                securityCheckmark.classList.add('show');
                
                setTimeout(() => {
                    successMessage.classList.add('show');
                    securitySubmitButton.classList.add('enabled');
                    showSecurityDetails(result);
                }, 500);
                
            } else {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞
                verificationBox.classList.add('failed');
                securityCheckbox.classList.add('failed');
                
                setTimeout(() => {
                    errorMessage.classList.add('show');
                    showSecurityDetails(result);
                    
                    // –°–±—Ä–æ—Å –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(resetVerification, 4000);
                }, 500);
            }
        }

        function resetVerification() {
            verificationBox.classList.remove('failed');
            securityCheckbox.classList.remove('failed');
            errorMessage.classList.remove('show');
            progressFill.style.width = '0%';
            securityDetails.classList.remove('show');
        }

        function showSecurityDetails(result) {
            const report = result.details || {};
            const riskLevel = (result.riskScore || 0) < 30 ? 'low' : (result.riskScore || 0) < 60 ? 'medium' : 'high';
            const riskText = (result.riskScore || 0) < 30 ? '–ù–∏–∑–∫–∏–π' : (result.riskScore || 0) < 60 ? '–°—Ä–µ–¥–Ω–∏–π' : '–í—ã—Å–æ–∫–∏–π';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å cookies –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            let cookieStatusText = '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            if (protection.cookiesSupported === true) {
                cookieStatusText = '‚úÖ –†–∞–±–æ—Ç–∞—é—Ç';
            } else if (protection.cookiesSupported === false) {
                cookieStatusText = '‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback';
            } else if (protection.cookieFallback && Object.keys(protection.cookieFallback).length > 0) {
                cookieStatusText = '‚ö†Ô∏è –¢–æ–ª—å–∫–æ fallback';
            }
            
            // –ó–∞—â–∏—â–∞–µ–º—Å—è –æ—Ç undefined –∑–Ω–∞—á–µ–Ω–∏–π
            const sessionDuration = report.sessionDuration || (Date.now() - protection.sessionStart);
            const mouseMovements = report.mouseMovements || protection.mouseData?.length || 0;
            const clickEvents = report.clickEvents || protection.clickEvents?.length || 0;
            const keyboardEvents = report.keyboardEvents || protection.keyboardData?.length || 0;
            const honeypotTriggers = report.honeypotTriggers || protection.honeypotTriggers?.length || 0;
            const verificationAttempts = report.verificationAttempts || protection.verificationAttempts || 0;
            const fallbackActive = report.fallbackActive || (protection.cookieFallback ? Object.keys(protection.cookieFallback).length : 0);
            const riskScore = result.riskScore || protection.riskScore || 0;
            const confidence = result.confidence || protection.confidenceLevel || 0;
            
            securityMetrics.innerHTML = `
                <div class="security-metric">
                    <span class="metric-label">–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:</span>
                    <span class="metric-value">
                        <span class="security-level level-${riskLevel}">${riskText}</span>
                        (${riskScore}/100)
                    </span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">–£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è:</span>
                    <span class="metric-value">${confidence}%</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">–í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏:</span>
                    <span class="metric-value">${Math.round(sessionDuration/1000)}—Å</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">–î–≤–∏–∂–µ–Ω–∏—è –º—ã—à–∏:</span>
                    <span class="metric-value">${mouseMovements}</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">–ö–ª–∏–∫–∏:</span>
                    <span class="metric-value">${clickEvents}</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">–ù–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à:</span>
                    <span class="metric-value">${keyboardEvents}</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">Cookie —Å—Ç–∞—Ç—É—Å:</span>
                    <span class="metric-value">${cookieStatusText}</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">Fallback –¥–∞–Ω–Ω—ã–µ:</span>
                    <span class="metric-value">${fallbackActive} –∑–∞–ø–∏—Å–µ–π</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">Honeypot —Ç—Ä–∏–≥–≥–µ—Ä—ã:</span>
                    <span class="metric-value">${honeypotTriggers > 0 ? 'üö® ' + honeypotTriggers : '‚úÖ 0'}</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">WebDriver:</span>
                    <span class="metric-value">${report.environmentRisk?.webdriver ? 'üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω' : '‚úÖ –ù–µ –Ω–∞–π–¥–µ–Ω'}</span>
                </div>
                <div class="security-metric">
                    <span class="metric-label">–ü–æ–ø—ã—Ç–∫–∏:</span>
                    <span class="metric-value">${verificationAttempts}</span>
                </div>
            `;
            
            securityDetails.classList.add('show');
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
            console.log('üîç –û—Ç–ª–∞–¥–∫–∞ –æ—Ç—á–µ—Ç–∞:', {
                riskScore: riskScore,
                confidence: confidence, 
                sessionDuration: sessionDuration,
                mouseMovements: mouseMovements,
                clickEvents: clickEvents,
                report: report,
                protectionState: {
                    riskScore: protection.riskScore,
                    confidenceLevel: protection.confidenceLevel,
                    mouseDataLength: protection.mouseData?.length,
                    clickEventsLength: protection.clickEvents?.length
                }
            });
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        securitySubmitButton.addEventListener('click', function() {
            if (!isVerified) return;
            
            const report = protection.generateDetailedReport();
            const summary = `
üõ°Ô∏è –û–¢–ß–ï–¢ –û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò üõ°Ô∏è

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: ${protection.riskScore}/100
‚Ä¢ –£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è: ${protection.confidenceLevel}%
‚Ä¢ –í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏: ${Math.round(report.sessionDuration/1000)} —Å–µ–∫—É–Ω–¥
‚Ä¢ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${report.mouseMovements} –¥–≤–∏–∂–µ–Ω–∏–π –º—ã—à–∏, ${report.clickEvents} –∫–ª–∏–∫–æ–≤
‚Ä¢ Cookie –∑–∞—â–∏—Ç–∞: ${report.cookieStatus ? '–ê–∫—Ç–∏–≤–Ω–∞' : '–ù–∞—Ä—É—à–µ–Ω–∞'}
‚Ä¢ Honeypot –ª–æ–≤—É—à–∫–∏: ${report.honeypotTriggers} —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
‚Ä¢ –ü–æ–ø—ã—Ç–∫–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏: ${report.verificationAttempts}

üîí –°–µ—Å—Å–∏—è –∑–∞—â–∏—â–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ v2.0
            `;
            
            alert(summary);
        });

        // –≠—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
        verificationBox.addEventListener('mouseenter', function() {
            if (!isVerified && !isVerifying) {
                this.style.transform = 'translateY(-3px)';
                this.style.boxShadow = '0 15px 35px rgba(0,0,0,0.15)';
            }
        });

        verificationBox.addEventListener('mouseleave', function() {
            if (!isVerified && !isVerifying) {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.2)';
            }
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–°–±—Ä–æ—Å–∏—Ç—å —Å–µ—Å—Å–∏—é" –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function addResetButton() {
            const resetButton = document.createElement('button');
            resetButton.textContent = 'üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–µ—Å—Å–∏—é';
            resetButton.style.cssText = `
                margin-top: 10px;
                padding: 8px 16px;
                background: #6c757d;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 12px;
            `;
            
            resetButton.addEventListener('click', () => {
                // –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
                protection.clearPreviousSession();
                location.reload();
            });
            
            document.querySelector('.security-container').appendChild(resetButton);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
        console.log('üöÄ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!');
        console.log('‚ÑπÔ∏è Honeypot —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏');
        console.log('‚ÑπÔ∏è Audio fingerprinting –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ Chrome)');
        
        // –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
        setTimeout(() => {
            console.log('üìã –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è:');
            console.log('- Cookies –ø–æ–¥–¥–µ—Ä–∂–∫–∞:', protection.cookiesSupported);
            console.log('- Cookies —Ä–∞–±–æ—Ç–∞—é—â–∏–µ:', protection.cookiesWorking);
            console.log('- Fallback –∑–∞–ø–∏—Å–∏:', protection.cookieFallback ? Object.keys(protection.cookieFallback).length : 0);
            console.log('- –†–µ–∞–ª—å–Ω—ã–µ cookies:', document.cookie.split(';').filter(c => c.trim()).length);
            console.log('- Risk score:', protection.riskScore);
            console.log('- Confidence:', protection.confidenceLevel + '%');
            console.log('- –í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏:', Math.round((Date.now() - protection.sessionStart)/1000) + '—Å');
            console.log('- Audio fingerprint:', protection.browserFingerprint?.audioFingerprint || 'pending');
        }, 2000);
    </script>
</body>
</html>